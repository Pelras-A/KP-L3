"0",""
"0","TIME <- data.frame(time = sort(unique(data$time)))"
"0","H0B <- data.frame(time = sort(unique(data$time)))"
"0",""
"0","nb_ech_bootstrap = 1000"
"0","  "
"0","  # INITIALISATION"
"0","  "
"0","  vec_rmst <- NULL"
"0",""
"0","  AU <- NULL"
"0","  "
"0","  SOMME <- 0"
"0","  "
"0","  Brier_1mois_train <- NULL"
"0","  Brier_1mois_val <- NULL"
"0","  Brier_3mois_train <- NULL"
"0","  Brier_3mois_val <- NULL"
"0","  Brier_6mois_train <- NULL"
"0","  Brier_6mois_val <- NULL"
"0",""
"0","  Brier_integer_train <- NULL"
"0","  Brier_integer_val <- NULL"
"0","  "
"0","  AUC_ROC_1mois_train <- NULL"
"0","  AUC_ROC_3mois_train <- NULL"
"0","  AUC_ROC_6mois_train <- NULL"
"0","  AUC_ROC_train <- NULL"
"0","  "
"0","  AUC_ROC_1mois_val <- NULL"
"0","  AUC_ROC_3mois_val <- NULL"
"0","  AUC_ROC_6mois_val <- NULL"
"0","  AUC_ROC_val <- NULL"
"0","  "
"0","  res_LASSO <- matrix(ncol = nb_ech_bootstrap, nrow = length(covariables)) "
"0","  res_LASSO <- data.frame(res_LASSO)"
"0","  "
"0","#===============================PROGRESSBAR========================================================"
"0",""
"0","pb <- progress_bar$new(format = ""(:spin) [:bar] :percent [Elapsed time: :elapsedfull || Estimated time remaining: :eta]"","
"0","                       total = nb_ech_bootstrap,"
"0","                       complete = ""="",   # Completion bar character"
"0","                       incomplete = ""-"", # Incomplete bar character"
"0","                       current = "">"",    # Current bar character"
"0","                       clear = FALSE,    # If TRUE, clears the bar when finish"
"0","                       width = 100)      # Width of the progress bar"
"0",""
"0","  "
"0","  for(j in 1:nb_BDD_completes){"
"0","    "
"0","    # Updates the current state"
"0","      pb$tick()"
"0","    "
"0","      #--------------------------------------------"
"0","      # Code to be executed"
"0","      #--------------------------------------------"
"0","    "
"0","    data_tmp = complete(MICE, j)"
"0","    "
"0","    for(i in (1+nb_ech_bootstrap*(j-1)):(nb_ech_bootstrap*j)) {"
"0",""
"0","  "
"0","    ###############################################################################################"
"0","    ##                                            TIRAGE                                         ##"
"0","    ###############################################################################################"
"0","    "
"0","    train <- data_tmp[sample(1:nrow(data_tmp), nrow(data_tmp), replace = TRUE),]"
"0","    val <- data_tmp[-unique(train$N),]"
"0","    "
"0","    "
"0","    "
"0","    "
"0","    ###############################################################################################"
"0","    ##                                          DESCRIPTION                                      ##"
"0","    ###############################################################################################"
"0","    "
"0","    "
"0","    "
"0","    #Aire sous la courbe de survie + IC"
"0","    "
"0","    KM_train <- survfit(Surv(train$time,train$status==1) ~ 1,  type = ""kaplan-meier"",  error = ""greenwood"")"
"0","    "
"0","    vec_rmst <- c(vec_rmst, rmst(times = summary(KM_train)$time, "
"0","                                 surv.rates = summary(KM_train)$surv, "
"0","                                 max.time = max(KM_train$time),#mois"
"0","                                 type = ""s""))"
"0","    "
"0","    "
"0","    "
"0","    ###############################################################################################"
"0","    ##                                     ANALYSES UNIVARIEES                                   ##"
"0","    ###############################################################################################  "
"0","  "
"0","    "
"0","    AU <- c(AU,HR(train, covariables))"
"0","    "
"0","    "
"0","    "
"0","    ###############################################################################################"
"0","    ##                                           LASSO                                           ##"
"0","    ###############################################################################################"
"0","    "
"0","    X <- as.matrix(select(train,-c(N,time,status)))"
"0","    Y <- Surv(train$time, train$status)"
"0","    tmp_LASSO <- LASSO(x = X, y = Y)"
"0","    res_LASSO[,i] <- suppressWarnings(tmp_LASSO$beta[1:length(covariables)])"
"0","    "
"0","    lp.lasso <- predict(tmp_LASSO, X)"
"0","    "
"0","    b <- Breslow(times = train$time, failures = train$status, lp = lp.lasso)"
"0","    "
"0","    H0 <- data.frame(value = b, time = unique(sort(train$time)))"
"0","    H0 <- data.frame(time = TIME$time,value = LOCF(left_join(TIME,H0,by =""time"")$value))"
"0","    "
"0","    "
"0","    "
"0","    H0B <- cbind(H0B,H0$value)"
"0","    "
"0","    pred.temp <- exp(matrix(exp(lp.lasso))%*%t(as.matrix(-1*H0$value)))"
"0","    pred.temp[is.na(pred.temp)] <- 1"
"0","    "
"0","    SOMME <- SOMME + pred.temp"
"0","    "
"0","    ###############################################################################################"
"0","    ##                                         METRIQUES                                         ##"
"0","    ###############################################################################################"
"0","    "
"0","    "
"0","    #--------------------------------------------Train---------------------------------------------"
"0","    "
"0","    Brier_1mois_train <- c(Brier_1mois_train, metrics(times = ""time"","
"0","                                                     failures = ""status"","
"0","                                                     data = train,"
"0","                                                     prediction.matrix = pred.temp,"
"0","                                                     prediction.times = sort(unique(train$time)),"
"0","                                                     metric = ""bs"","
"0","                                                     pro.time = 1))"
"0","    "
"0","    Brier_3mois_train <- c(Brier_3mois_train, metrics(times = ""time"","
"0","                                                     failures = ""status"","
"0","                                                     data = train,"
"0","                                                     prediction.matrix = pred.temp,"
"0","                                                     prediction.times = sort(unique(train$time)),"
"0","                                                     metric = ""bs"","
"0","                                                     pro.time = 3))"
"0","    "
"0","    Brier_6mois_train <- c(Brier_6mois_train, metrics(times = ""time"","
"0","                                                     failures = ""status"","
"0","                                                     data = train,"
"0","                                                     prediction.matrix = pred.temp,"
"0","                                                     prediction.times = sort(unique(train$time)),"
"0","                                                     metric = ""bs"","
"0","                                                     pro.time = 6))"
"0","    "
"0","    Brier_integer_train <- c(Brier_integer_train, metrics(times = ""time"","
"0","                                                          failures = ""status"","
"0","                                                          data = train,"
"0","                                                          prediction.matrix = pred.temp,"
"0","                                                          prediction.times = sort(unique(train$time)),"
"0","                                                          metric = ""ibs""))"
"0","                              "
"0","    AUC_ROC_1mois_train <- c(AUC_ROC_1mois_train, metrics(times = ""time"","
"0","                                                   failures = ""status"","
"0","                                                   data = train,"
"0","                                                   prediction.matrix = pred.temp,"
"0","                                                   prediction.times = sort(unique(train$time)),"
"0","                                                   metric = ""auc"","
"0","                                                   pro.time = 1))"
"0","    "
"0","    AUC_ROC_3mois_train <- c(AUC_ROC_3mois_train, metrics(times = ""time"","
"0","                                                   failures = ""status"","
"0","                                                   data = train,"
"0","                                                   prediction.matrix = pred.temp,"
"0","                                                   prediction.times = sort(unique(train$time)),"
"0","                                                   metric = ""auc"","
"0","                                                   pro.time = 3))"
"0","    "
"0","    AUC_ROC_6mois_train <- c(AUC_ROC_6mois_train, metrics(times = ""time"","
"0","                                                   failures = ""status"","
"0","                                                   data = train,"
"0","                                                   prediction.matrix = pred.temp,"
"0","                                                   prediction.times = sort(unique(train$time)),"
"0","                                                   metric = ""auc"","
"0","                                                   pro.time = 6))"
"0",""
"0","    "
"0","      "
"0","# #-------------------------------------------Validation-----------------------------------------"
"0","# "
"0","# X <- as.matrix(select(val,-c(N,time,status)))"
"0","# "
"0","# lp.val.lasso <- predict(tmp_LASSO, X)"
"0","# "
"0","# pred.val.temp <- exp(matrix(exp(lp.val.lasso))%*%t(as.matrix(-1*H0$value)))"
"0","# "
"0","# "
"0","# Brier_1mois_val <- c(Brier_1mois_val, metrics(times = ""time"","
"0","#                                              failures = ""status"","
"0","#                                              data = val,"
"0","#                                              prediction.matrix = pred.val.temp,"
"0","#                                              prediction.times = sort(unique(train$time)),"
"0","#                                              metrics = ""bs"","
"0","#                                              pro.time = 1))"
"0","# "
"0","# Brier_3mois_val <- c(Brier_3mois_val, metrics(times = ""time"","
"0","#                                              failures = ""status"","
"0","#                                              data = val,"
"0","#                                              prediction.matrix = pred.val.temp,"
"0","#                                              prediction.times = sort(unique(train$time)),"
"0","#                                              metrics = ""bs"","
"0","#                                              pro.time = 3))"
"0","# "
"0","# Brier_6mois_val <- c(Brier_6mois_val, metrics(times = ""time"","
"0","#                                              failures = ""status"","
"0","#                                              data = val,"
"0","#                                              prediction.matrix = pred.val.temp,"
"0","#                                              prediction.times = sort(unique(train$time)),"
"0","#                                              metrics = ""bs"","
"0","#                                              pro.time = 6))"
"0","# "
"0","# Brier_integer_val <- c(Brier_integer_val, metrics(times = ""time"","
"0","#                                                  failures = ""status"","
"0","#                                                  data = val,"
"0","#                                                  prediction.matrix = pred.val.temp,"
"0","#                                                  prediction.times = sort(unique(train$time)),"
"0","#                                                  metrics = ""ibs""))"
"0","# "
"0","# AUC_ROC_1mois_val <- c(AUC_ROC_1mois_val, metrics(times = ""time"","
"0","#                                                failures = ""status"","
"0","#                                                data = val,"
"0","#                                                prediction.matrix = pred.temp,"
"0","#                                                prediction.times = sort(unique(train$time)),"
"0","#                                                metrics = ""auc"","
"0","#                                                pro.time = 1))"
"0","# "
"0","# AUC_ROC_3mois_val <- c(AUC_ROC_3mois_val, metrics(times = ""time"","
"0","#                                      failures = ""status"","
"0","#                                      data = val,"
"0","#                                      prediction.matrix = pred.val.temp,"
"0","#                                      prediction.times = sort(unique(train$time)),"
"0","#                                      metrics = ""auc"","
"0","#                                      pro.time = 3))"
"0","# "
"0","# AUC_ROC_6mois_val <- c(AUC_ROC_6mois_val, metrics(times = ""time"","
"0","#                                                failures = ""status"","
"0","#                                                data = val,"
"0","#                                                prediction.matrix = pred.temp,"
"0","#                                                prediction.times = sort(unique(train$time)),"
"0","#                                                metrics = ""auc"","
"0","#                                                pro.time = 6))"
"0",""
"0","    ###############################################################################################"
"0","    ##                                      Cox sans LASSO                                       ##"
"0","    ##                                        MULTIVARIE                                         ##"
"0","    ###############################################################################################"
"0","    "
"0","    "
"0","    }"
"0","  }"
"2","Loglik converged before variable  1 ; coefficient may be infinite. "
"2",""
"2","(-) [-------------------------------]   0% [Elapsed time: 00:08:11 || Estimated time remaining:  3d]"
"2",""
"2","(\) [-------------------------------]   0% [Elapsed time: 00:16:27 || Estimated time remaining:  4d]"
"2",""
"2","(|) [-------------------------------]   0% [Elapsed time: 00:25:03 || Estimated time remaining:  4d]"
"2",""
"2","(/) [-------------------------------]   0% [Elapsed time: 00:33:54 || Estimated time remaining:  5d]"
